<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entra Sign-in URL Builder - Generate Microsoft Entra OAuth 2.0 Authorization URLs</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Free online tool to generate Microsoft Entra ID OAuth 2.0 sign-in URLs. Build authorization URLs for single-tenant, multi-tenant, and consumer authentication flows with custom parameters.">
    <meta name="keywords" content="Microsoft Entra ID, Azure AD, OAuth 2.0, sign-in URL generator, authorization URL builder, Azure authentication, OIDC, Microsoft Graph, tenant authentication, SSO">
    <meta name="author" content="Entra Sign-in URL Builder">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://entra-url-builder.com/">
    <meta property="og:title" content="Entra Sign-in URL Builder - Generate Microsoft Entra ID OAuth URLs">
    <meta property="og:description" content="Free online tool to generate Microsoft Entra ID OAuth 2.0 sign-in URLs. Build authorization URLs for single-tenant, multi-tenant, and consumer authentication flows.">
    <meta property="og:image" content="https://entra-url-builder.com/icon.svg">
    <meta property="og:site_name" content="Entra Sign-in URL Builder">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://entra-url-builder.com/">
    <meta property="twitter:title" content="Entra Sign-in URL Builder - Generate Microsoft Entra OAuth URLs">
    <meta property="twitter:description" content="Free online tool to generate Microsoft Entra ID OAuth 2.0 sign-in URLs. Build authorization URLs for authentication flows.">
    <meta property="twitter:image" content="https://entra-url-builder.com/icon.svg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="icon.svg">
    <link rel="manifest" href="manifest.json">
    
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Entra Sign-in URL Builder",
        "description": "Free online tool to generate Microsoft Entra ID OAuth 2.0 sign-in URLs for authentication flows",
        "url": "https://entra-url-builder.com/",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Organization",
            "name": "Entra Sign-in URL Builder"
        },
        "keywords": "Microsoft Entra ID, Azure AD, OAuth 2.0, URL generator, authentication"
    }
    </script>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        /* Shadcn-inspired CSS Variables */
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%;
            --popover-foreground: 222.2 84% 4.9%;
            --primary: 221.2 83.2% 53.3%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96%;
            --secondary-foreground: 222.2 84% 4.9%;
            --muted: 210 40% 96%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96%;
            --accent-foreground: 222.2 84% 4.9%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 221.2 83.2% 53.3%;
            --radius: 0.5rem;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: hsl(var(--muted));
            min-height: 100vh;
            padding: 1rem;
        }
        /* Shadcn-inspired component styles */
        .card {
            background-color: hsl(var(--card));
            color: hsl(var(--card-foreground));
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) + 2px);
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        
        .input {
            display: flex;
            height: 2.5rem;
            width: 100%;
            border-radius: calc(var(--radius));
            border: 1px solid hsl(var(--input));
            background-color: hsl(var(--background));
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        
        .input:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }
        
        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            border-radius: calc(var(--radius));
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            height: 2.5rem;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border: none;
        }
        
        .button-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        .button-primary:hover {
            background-color: hsl(var(--primary) / 0.9);
        }
        
        .button-secondary {
            background-color: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
            border: 1px solid hsl(var(--border));
        }
        
        .button-secondary:hover {
            background-color: hsl(var(--secondary) / 0.8);
        }
        
        .select {
            display: flex;
            height: 2.5rem;
            width: 100%;
            border-radius: calc(var(--radius));
            border: 1px solid hsl(var(--input));
            background-color: hsl(var(--background));
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        
        .select:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }
        
        .textarea {
            display: flex;
            min-height: 5rem;
            width: 100%;
            border-radius: calc(var(--radius));
            border: 1px solid hsl(var(--input));
            background-color: hsl(var(--background));
            padding: 0.5rem 0.75rem;
            font-size: 0.875rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        
        .textarea:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }
        
        .label {
            font-size: 0.875rem;
            font-weight: 500;
            color: hsl(var(--foreground));
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .alert {
            border-radius: calc(var(--radius));
            border: 1px solid hsl(var(--border));
            padding: 1rem;
            position: relative;
        }
        
        .alert-success {
            background-color: hsl(142.1 76.2% 36.3% / 0.1);
            border-color: hsl(142.1 76.2% 36.3% / 0.2);
            color: hsl(142.1 70.6% 45.3%);
        }
        
        .alert-error {
            background-color: hsl(var(--destructive) / 0.1);
            border-color: hsl(var(--destructive) / 0.2);
            color: hsl(var(--destructive));
        }
        
        .alert-info {
            background-color: hsl(var(--primary) / 0.1);
            border-color: hsl(var(--primary) / 0.2);
            color: hsl(var(--primary));
        }
        
        .field-hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container mx-auto max-w-4xl p-6">
        <!-- Header -->
        <div class="card p-8 mb-8">
            <div class="flex items-center gap-4 mb-4">
                <div class="w-16 h-16 flex-shrink-0">
                    <img src="icon.svg" alt="Entra URL Builder Logo" class="w-full h-full object-contain">
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">Entra Sign-in URL Builder</h1>
                    <p class="text-sm text-gray-600">Generate OAuth 2.0 authorization URLs for Microsoft Entra ID</p>
                </div>
            </div>
        </div>

        <!-- Main Form -->
        <div class="card p-8">
            <form id="urlForm" class="space-y-8">
                <!-- Base URL Configuration -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 mb-4">
                        <i data-lucide="globe" class="w-4 h-4 text-gray-600"></i>
                        <h2 class="text-lg font-semibold text-gray-900">Base Configuration</h2>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label for="urlType" class="label">URL Type</label>
                            <select id="urlType" class="select">
                                <option value="auth">Authorization URL (User Sign-in)</option>
                                <option value="admin_consent">Admin Consent URL</option>
                            </select>
                            <p class="text-xs text-gray-500">Choose whether to generate a user authorization URL for sign-in or an admin consent URL for tenant-wide permissions</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="baseUrlType" class="label">Base URL Type</label>
                            <select id="baseUrlType" class="select">
                                <option value="specific">Specific Tenant</option>
                                <option value="common">Multi-tenant (common)</option>
                                <option value="consumers">Microsoft Accounts (consumers)</option>
                                <option value="organizations">Work/School & Personal (organizations)</option>
                            </select>
                            <p class="text-xs text-gray-500">Choose the authentication endpoint: specific tenant for single organization, common for multi-tenant apps, consumers for personal Microsoft accounts only, or organizations for work/school accounts from any organization</p>
                        </div>
                        
                        <div class="space-y-2" id="tenantIdField">
                            <label for="tenantId" class="label">Tenant ID or Name</label>
                            <input type="text" id="tenantId" class="input" placeholder="e.g., yourcompany.onmicrosoft.com or tenant-id">
                            <p class="text-xs text-gray-500">Your Entra ID tenant identifier - can be the tenant GUID, domain name (contoso.onmicrosoft.com), or verified custom domain (contoso.com)</p>
                        </div>
                    </div>
                </div>

                <!-- Essential Parameters -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 mb-4">
                        <i data-lucide="settings" class="w-4 h-4 text-gray-600"></i>
                        <h2 class="text-lg font-semibold text-gray-900">Essential Parameters</h2>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label for="clientId" class="label">
                                Client ID (Application ID) 
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="clientId" class="input" placeholder="Required" required>
                            <p class="text-xs text-gray-500">Unique identifier for your application, found in Entra portal under <a href="https://enappreg.cmd.ms" target="_blank">App registrations</a> â†’ Your app â†’ Overview. Also called Application (client) ID</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="redirectUri" class="label">
                                Redirect URI 
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="url" id="redirectUri" class="input" placeholder="e.g., http://localhost:3000/callback" required>
                            <p class="text-xs text-gray-500" id="redirectUriHelp">Where users are sent after authentication. Must exactly match a URI configured in your app registration's Authentication settings</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="scope" class="label">
                                Scope (space-separated) 
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="scope" class="input" value="openid profile email offline_access https://graph.microsoft.com/User.Read" placeholder="Required">
                            <p class="text-xs text-gray-500" id="scopeHelp">Permissions your app requests. Include 'openid' for OIDC, 'profile' for user info, 'email' for email claims, 'offline_access' for refresh tokens, plus any API scopes</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="responseType" class="label">Response Type</label>
                            <select id="responseType" class="select">
                                <option value="code">code (Auth Code Flow)</option>
                                <option value="id_token">id_token (Implicit Flow)</option>
                                <option value="code id_token">code id_token</option>
                            </select>
                            <p class="text-xs text-gray-500" id="responseTypeHelp">Determines what is returned: 'code' for authorization code (most secure), 'id_token' for immediate token (less secure), or both for hybrid flows</p>
                        </div>

                        <!-- Admin Consent specific fields -->
                        <div class="space-y-2 field-hidden" id="adminConsentFields">
                            <label for="adminConsentState" class="label">State (for Admin Consent)</label>
                            <input type="text" id="adminConsentState" class="input" placeholder="Optional state parameter">
                            <p class="text-xs text-gray-500">Optional state parameter that will be returned after admin consent is granted</p>
                        </div>
                    </div>
                </div>

                <!-- Optional Parameters -->
                <div class="space-y-4">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2">
                            <i data-lucide="sliders-horizontal" class="w-4 h-4 text-gray-600"></i>
                            <h2 class="text-lg font-semibold text-gray-900">Optional Parameters</h2>
                        </div>
                        <button type="button" id="toggleOptionalParams" class="button button-secondary text-sm py-1 px-2 h-auto">
                            <i data-lucide="chevron-down" class="w-4 h-4 mr-1" id="optionalParamsIcon"></i>
                            <span id="optionalParamsText">Show</span>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 field-hidden" id="optionalParamsSection">
                        <div class="space-y-2">
                            <label for="state" class="label">State</label>
                            <input type="text" id="state" class="input" placeholder="Optional (for CSRF protection)">
                            <p class="text-xs text-gray-500">Random value to prevent CSRF attacks. Azure AD returns this exact value in the response, allowing your app to verify the request authenticity</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="nonce" class="label">Nonce</label>
                            <input type="text" id="nonce" class="input" placeholder="Optional (for replay protection)">
                            <p class="text-xs text-gray-500">Random value included in ID tokens to prevent replay attacks. Must be unique for each authentication request to ensure token freshness</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="responseMode" class="label">Response Mode</label>
                            <select id="responseMode" class="select">
                                <option value="form_post">form_post</option>
                                <option value="query">query</option>
                                <option value="fragment">fragment</option>
                            </select>
                            <p class="text-xs text-gray-500">How the authorization response is returned: form_post (HTTP POST to redirect URI), query (URL parameters), or fragment (URL hash for SPAs)</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="prompt" class="label">Prompt</label>
                            <select id="prompt" class="select">
                                <option value="">None</option>
                                <option value="select_account">select_account</option>
                                <option value="consent">consent</option>
                                <option value="login">login</option>
                                <option value="none">none (silent)</option>
                            </select>
                            <p class="text-xs text-gray-500">Controls user interaction: none (default), select_account (show account picker), consent (force consent screen), login (force re-authentication), none (silent auth)</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="loginHint" class="label">Login Hint</label>
                            <input type="text" id="loginHint" class="input" placeholder="user@example.com">
                            <p class="text-xs text-gray-500">Pre-populate the username field on the sign-in page. Useful when you know the user's email or username in advance</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label for="domainHint" class="label">Domain Hint</label>
                            <input type="text" id="domainHint" class="input" placeholder="contoso.com">
                            <p class="text-xs text-gray-500">Skip the home realm discovery page and send user directly to their federated identity provider (e.g., ADFS) for the specified domain</p>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3 justify-end pt-6 border-t border-gray-200">
                    <button type="button" id="clearForm" class="button button-secondary">
                        <i data-lucide="refresh-cw" class="w-4 h-4 mr-2"></i>
                        Clear Form
                    </button>
                    <button type="submit" class="button button-primary">
                        <i data-lucide="link" class="w-4 h-4 mr-2"></i>
                        Generate URL
                    </button>
                </div>
            </form>
        </div>

        <!-- Result Section -->
        <div class="card p-8 mt-8">
            <div class="flex items-center gap-2 mb-4">
                <i data-lucide="copy" class="w-4 h-4 text-gray-600"></i>
                <h2 class="text-lg font-semibold text-gray-900">Generated Sign-in URL</h2>
            </div>
            
            <div class="space-y-4">
                <textarea id="generatedUrl" rows="6" readonly class="textarea font-mono text-sm" placeholder="Your generated URL will appear here..."></textarea>
                <button id="copyUrl" class="button button-primary w-full">
                    <i data-lucide="clipboard" class="w-4 h-4 mr-2"></i>
                    Copy URL to Clipboard
                </button>
            </div>
            
            <div id="messageBox" class="mt-4 hidden"></div>
        </div>

        <!-- SEO Content Section -->
        <div class="card p-8 mt-8">
            <div class="prose max-w-none">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">About Entra Sign-in URL Builder</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-gray-600">
                    <div>
                        <h3 class="font-medium text-gray-900 mb-2">What is this tool?</h3>
                        <p class="mb-4">The Entra Sign-in URL Builder is a free online tool that helps developers generate Microsoft Entra ID OAuth 2.0 authorization URLs and admin consent URLs. This tool simplifies the process of creating properly formatted sign-in URLs for various authentication scenarios and tenant-wide consent flows.</p>
                        
                        <h3 class="font-medium text-gray-900 mb-2">Key Features</h3>
                        <ul class="list-disc list-inside space-y-1 mb-4">
                            <li>Support for single-tenant, multi-tenant, and consumer flows</li>
                            <li>Admin consent URL generation for tenant-wide permissions</li>
                            <li>Customizable OAuth 2.0 parameters</li>
                            <li>CSRF and replay protection with state and nonce generation</li>
                            <li>Copy-to-clipboard functionality</li>
                            <li>Real-time URL validation</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-900 mb-2">Supported Authentication Flows</h3>
                        <ul class="list-disc list-inside space-y-1 mb-4">
                            <li><strong>Authorization Code Flow:</strong> Most secure flow for web applications</li>
                            <li><strong>Implicit Flow:</strong> For single-page applications (deprecated)</li>
                            <li><strong>Hybrid Flow:</strong> Combination of code and implicit flows</li>
                        </ul>
                        
                        <h3 class="font-medium text-gray-900 mb-2">Use Cases</h3>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Testing Microsoft Graph API integrations</li>
                            <li>Debugging Entra ID authentication issues</li>
                            <li>Creating sign-in links for applications</li>
                            <li>Generating admin consent URLs for tenant-wide permissions</li>
                            <li>Learning OAuth 2.0 and OpenID Connect flows</li>
                            <li>Rapid prototyping of authentication workflows</li>
                        </ul>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-medium text-blue-900 mb-2">ðŸ’¡ Pro Tips</h3>
                    <ul class="text-sm text-blue-800 space-y-1">
                        <li>â€¢ Always use HTTPS redirect URIs in production environments</li>
                        <li>â€¢ Include appropriate scopes based on your application's requirements</li>
                        <li>â€¢ Use the state parameter to prevent CSRF attacks</li>
                        <li>â€¢ For admin consent, use .default scope to request all configured permissions</li>
                        <li>â€¢ Test with different tenant types to ensure compatibility</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional SEO Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Generate Microsoft Entra ID Sign-in URLs",
        "description": "Step-by-step guide to create OAuth 2.0 authorization URLs for Microsoft Entra ID authentication",
        "step": [
            {
                "@type": "HowToStep",
                "name": "Select Base URL Type",
                "text": "Choose between specific tenant, multi-tenant, consumers, or organizations authentication endpoint"
            },
            {
                "@type": "HowToStep", 
                "name": "Enter Required Parameters",
                "text": "Provide Client ID, Redirect URI, and Scopes for your application"
            },
            {
                "@type": "HowToStep",
                "name": "Configure Optional Parameters",
                "text": "Set response type, prompt behavior, and security parameters like state and nonce"
            },
            {
                "@type": "HowToStep",
                "name": "Generate and Copy URL",
                "text": "Click Generate URL button and copy the resulting authorization URL to your clipboard"
            }
        ]
    }
    </script>

    <script>
        // Get references to DOM elements
        const urlForm = document.getElementById('urlForm');
        const urlType = document.getElementById('urlType');
        const baseUrlType = document.getElementById('baseUrlType');
        const tenantIdField = document.getElementById('tenantIdField');
        const tenantIdInput = document.getElementById('tenantId');
        const clientIdInput = document.getElementById('clientId');
        const redirectUriInput = document.getElementById('redirectUri');
        const scopeInput = document.getElementById('scope');
        const responseTypeSelect = document.getElementById('responseType');
        const stateInput = document.getElementById('state');
        const nonceInput = document.getElementById('nonce');
        const responseModeSelect = document.getElementById('responseMode');
        const promptSelect = document.getElementById('prompt');
        const loginHintInput = document.getElementById('loginHint');
        const domainHintInput = document.getElementById('domainHint');
        const adminConsentFields = document.getElementById('adminConsentFields');
        const adminConsentState = document.getElementById('adminConsentState');
        const generatedUrlTextarea = document.getElementById('generatedUrl');
        const copyUrlButton = document.getElementById('copyUrl');
        const clearFormButton = document.getElementById('clearForm');
        const messageBox = document.getElementById('messageBox');
        const toggleOptionalParamsButton = document.getElementById('toggleOptionalParams');
        const optionalParamsSection = document.getElementById('optionalParamsSection');
        const optionalParamsIcon = document.getElementById('optionalParamsIcon');
        const optionalParamsText = document.getElementById('optionalParamsText');

        // Function to toggle optional parameters visibility
        function toggleOptionalParams() {
            const isHidden = optionalParamsSection.classList.contains('field-hidden');
            
            if (isHidden) {
                optionalParamsSection.classList.remove('field-hidden');
                optionalParamsIcon.setAttribute('data-lucide', 'chevron-up');
                optionalParamsText.textContent = 'Hide';
            } else {
                optionalParamsSection.classList.add('field-hidden');
                optionalParamsIcon.setAttribute('data-lucide', 'chevron-down');
                optionalParamsText.textContent = 'Show';
            }
            
            // Reinitialize Lucide icons for the updated icon
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        // Function to toggle fields based on URL type
        function toggleUrlTypeFields() {
            const isAdminConsent = urlType.value === 'admin_consent';
            
            if (isAdminConsent) {
                // Show admin consent fields
                adminConsentFields.classList.remove('field-hidden');
                
                // Update help text for admin consent
                document.getElementById('redirectUriHelp').textContent = 'Optional redirect URI for admin consent callback. If not provided, admin will be redirected to the app registration portal';
                document.getElementById('scopeHelp').textContent = 'API permissions that require admin consent. Use space-separated scopes like https://graph.microsoft.com/.default';
                document.getElementById('responseTypeHelp').textContent = 'Not used for admin consent URLs, but kept for consistency';
                
                // Update labels
                document.querySelector('label[for="redirectUri"] span').style.display = 'none'; // Hide required asterisk
                document.querySelector('label[for="scope"] span').style.display = 'none'; // Hide required asterisk
                redirectUriInput.removeAttribute('required');
                
                // Set default scope for admin consent
                if (scopeInput.value === 'openid profile email offline_access https://graph.microsoft.com/User.Read') {
                    scopeInput.value = 'https://graph.microsoft.com/.default';
                }
            } else {
                // Hide admin consent fields
                adminConsentFields.classList.add('field-hidden');
                
                // Restore original help text
                document.getElementById('redirectUriHelp').textContent = 'Where users are sent after authentication. Must exactly match a URI configured in your app registration\'s Authentication settings';
                document.getElementById('scopeHelp').textContent = 'Permissions your app requests. Include \'openid\' for OIDC, \'profile\' for user info, \'email\' for email claims, \'offline_access\' for refresh tokens, plus any API scopes';
                document.getElementById('responseTypeHelp').textContent = 'Determines what is returned: \'code\' for authorization code (most secure), \'id_token\' for immediate token (less secure), or both for hybrid flows';
                
                // Restore required fields
                document.querySelector('label[for="redirectUri"] span').style.display = 'inline'; // Show required asterisk
                document.querySelector('label[for="scope"] span').style.display = 'inline'; // Show required asterisk
                redirectUriInput.setAttribute('required', 'true');
                
                // Restore default scope for auth
                if (scopeInput.value === 'https://graph.microsoft.com/.default') {
                    scopeInput.value = 'openid profile email offline_access https://graph.microsoft.com/User.Read';
                }
            }
        }

        // Function to show/hide tenantId field based on baseUrlType
        function toggleTenantIdField() {
            if (baseUrlType.value === 'specific') {
                tenantIdField.style.display = 'block';
                tenantIdInput.setAttribute('required', 'true');
            } else {
                tenantIdField.style.display = 'none';
                tenantIdInput.removeAttribute('required');
                tenantIdInput.value = ''; // Clear tenant ID if not specific
            }
        }

        // Event listener for URL type change
        urlType.addEventListener('change', toggleUrlTypeFields);
        
        // Event listener for baseUrlType change
        baseUrlType.addEventListener('change', toggleTenantIdField);
        
        // Event listener for optional parameters toggle
        toggleOptionalParamsButton.addEventListener('click', toggleOptionalParams);
        
        // Initial call to set correct visibility on load
        document.addEventListener('DOMContentLoaded', function() {
            toggleTenantIdField();
            toggleUrlTypeFields();
        });

        // Function to display messages to the user
        function showMessage(message, type = 'info') {
            messageBox.textContent = message;
            messageBox.classList.remove('hidden');
            messageBox.className = 'mt-4 alert ' + (type === 'error' ? 'alert-error' : type === 'success' ? 'alert-success' : 'alert-info');
            
            // Add icon based on type
            const icon = type === 'error' ? 'alert-circle' : type === 'success' ? 'check-circle' : 'info';
            messageBox.innerHTML = `<i data-lucide="${icon}" class="w-4 h-4 inline mr-2"></i>${message}`;
            
            // Reinitialize Lucide icons for the new icon
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            
            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000); // Hide message after 3 seconds
        }

        // Function to generate the Entra sign-in URL or admin consent URL
        function generateUrl(event) {
            event.preventDefault(); // Prevent default form submission

            const isAdminConsent = urlType.value === 'admin_consent';
            
            // Base URL construction
            let baseUrl = '';
            const tenantId = tenantIdInput.value.trim();
            
            if (isAdminConsent) {
                // Admin consent URLs
                switch (baseUrlType.value) {
                    case 'specific':
                        if (!tenantId) {
                            showMessage('Please enter a Tenant ID or Name for "Specific Tenant" type.', 'error');
                            return;
                        }
                        baseUrl = `https://login.microsoftonline.com/${encodeURIComponent(tenantId)}/v2.0/adminconsent`;
                        break;
                    case 'common':
                        baseUrl = `https://login.microsoftonline.com/common/v2.0/adminconsent`;
                        break;
                    case 'consumers':
                        showMessage('Admin consent is not supported for consumer accounts.', 'error');
                        return;
                    case 'organizations':
                        baseUrl = `https://login.microsoftonline.com/organizations/v2.0/adminconsent`;
                        break;
                }
            } else {
                // Regular authorization URLs
                switch (baseUrlType.value) {
                    case 'specific':
                        if (!tenantId) {
                            showMessage('Please enter a Tenant ID or Name for "Specific Tenant" type.', 'error');
                            return;
                        }
                        baseUrl = `https://login.microsoftonline.com/${encodeURIComponent(tenantId)}/oauth2/v2.0/authorize`;
                        break;
                    case 'common':
                        baseUrl = `https://login.microsoftonline.com/common/oauth2/v2.0/authorize`;
                        break;
                    case 'consumers':
                        baseUrl = `https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize`;
                        break;
                    case 'organizations':
                        baseUrl = `https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize`;
                        break;
                }
            }

            // Get essential parameters
            const clientId = clientIdInput.value.trim();
            const redirectUri = redirectUriInput.value.trim();
            const scope = scopeInput.value.trim();

            // Validate required fields
            if (!clientId) {
                showMessage('Client ID is required.', 'error');
                return;
            }

            if (!isAdminConsent && (!redirectUri || !scope)) {
                showMessage('Client ID, Redirect URI, and Scope are required fields for authorization URLs.', 'error');
                return;
            }

            if (isAdminConsent && !scope) {
                showMessage('Client ID and Scope are required for admin consent URLs.', 'error');
                return;
            }

            // Construct query parameters
            const params = new URLSearchParams();
            params.append('client_id', clientId);

            if (isAdminConsent) {
                // Admin consent specific parameters
                if (redirectUri) {
                    params.append('redirect_uri', redirectUri);
                }
                if (scope) {
                    params.append('scope', scope);
                }
                if (adminConsentState.value.trim()) {
                    params.append('state', adminConsentState.value.trim());
                }
            } else {
                // Regular authorization parameters
                const responseType = responseTypeSelect.value;
                params.append('response_type', responseType);
                params.append('redirect_uri', redirectUri);
                params.append('scope', scope);

                // Add optional parameters if they have values
                if (stateInput.value.trim()) {
                    params.append('state', stateInput.value.trim());
                }
                if (nonceInput.value.trim()) {
                    params.append('nonce', nonceInput.value.trim());
                }
                if (responseModeSelect.value) {
                    params.append('response_mode', responseModeSelect.value);
                }
                if (promptSelect.value) {
                    params.append('prompt', promptSelect.value);
                }
                if (loginHintInput.value.trim()) {
                    params.append('login_hint', loginHintInput.value.trim());
                }
                if (domainHintInput.value.trim()) {
                    params.append('domain_hint', domainHintInput.value.trim());
                }
            }

            // Combine base URL and parameters
            const fullUrl = `${baseUrl}?${params.toString()}`;
            generatedUrlTextarea.value = fullUrl;
            const urlTypeText = isAdminConsent ? 'Admin consent URL' : 'Authorization URL';
            showMessage(`${urlTypeText} generated successfully!`, 'success');
        }

        // Function to copy the generated URL to clipboard
        function copyUrlToClipboard() {
            if (generatedUrlTextarea.value) {
                // Use document.execCommand('copy') as navigator.clipboard.writeText() may not work in some iframe environments
                generatedUrlTextarea.select();
                document.execCommand('copy');
                showMessage('URL copied to clipboard!', 'success');
            } else {
                showMessage('No URL to copy. Please generate one first.', 'info');
            }
        }

        // Function to clear all form fields
        function clearForm() {
            urlForm.reset(); // Resets all form fields to their initial state
            generatedUrlTextarea.value = ''; // Clear the generated URL
            toggleTenantIdField(); // Reset tenant ID field visibility
            toggleUrlTypeFields(); // Reset URL type fields
            showMessage('Form cleared.', 'info');
        }

        // Event listeners
        urlForm.addEventListener('submit', generateUrl);
        copyUrlButton.addEventListener('click', copyUrlToClipboard);
        clearFormButton.addEventListener('click', clearForm);

        // Generate a random state and nonce on load for convenience
        function generateRandomString(length) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0987654321';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }

        document.addEventListener('DOMContentLoaded', () => {
            stateInput.value = generateRandomString(32);
            nonceInput.value = generateRandomString(32);
            
            // Initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });

    </script>
</body>
</html>
